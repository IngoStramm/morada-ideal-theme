let autocomplete,map,lat=ajax_object.lat,lng=ajax_object.lng,itemsLista=Object.values(ajax_object.imoveis),todosImoveis=itemsLista,allInfoWindows=[],markers={};function initMap(){var e,t=document.getElementById("map");t&&(lat,lat)&&(lng,lng)&&(lat=Number(lat),lng=Number(lng),e={lat:lat,lng:lng},map=new google.maps.Map(t,{zoom:15,center:e,mapTypeControl:!1}),todosImoveis.forEach((e,t)=>{var a={lat:parseFloat(e.lat),lng:parseFloat(e.lng)};let l=`<div class="map-listing-item">
                <div class="inner-box">
                    <h5><a href="${e.post_url}">${e.title}</a></h5>
                    <address>
                    Endereço: ${e.rua}, ${e.numero} - ${e.cidade} / ${e.estado}, ${e.codigo_postal}
                    </address>
                </div>
            </div>`,o=new google.maps.InfoWindow({content:l,ariaLabel:e.title});allInfoWindows.push(o);var n,a=new google.maps.Marker({position:a,map:map,title:e.title});google.maps.event.addListener(a,"click",(n=a,function(){closeAllInfoWindows(),o.setContent(l),o.open(map,n),map.setZoom(16),map.setCenter(n.getPosition())})),markers[e.post_id]=a}))}function closeAllInfoWindows(){for(var e of allInfoWindows)e.close()}function miInitAutocomplete(){document.querySelectorAll(".autocomplete-wrapper").forEach(t=>{var a=t.querySelector(".autocomplete");if(a){autocomplete=new google.maps.places.Autocomplete(a,{componentRestrictions:{country:["PT"]},fields:["place_id","geometry","name","address_components"]});let e=t.querySelector(".autocomplete-message");a.addEventListener("change",e=>{}),autocomplete.addListener("place_changed",()=>miOnPlaceChanged(e))}})}function miSetInputsNewValue(e,t){e.forEach(e=>{e.value=t})}function miOnPlaceChanged(t){var a=autocomplete.getPlace(),l=t.closest("form"),o="true"===l.querySelector("input.autocomplete").getAttribute("data-validate");if(l){var n=l.querySelectorAll('input[name="lat"]'),r=l.querySelectorAll('input[name="lng"]'),i=l.querySelectorAll('input[name="imovel_estado"]'),s=l.querySelectorAll('input[name="imovel_cidade"]'),c=l.querySelectorAll('input[name="imovel_codigo_postal"]'),l=l.querySelectorAll('input[name="imovel_rua"]'),d=document.getElementById("new-imovel-form-btn");let e="";if(d&&(d.disabled=!0),t&&(t.style.display="block"),n)if(r)if(a.geometry){console.log(a.address_components),t.style.display="none",d&&(d.disabled=!1),lat=a.geometry.location.lat(),lng=a.geometry.location.lng();var m=a.address_components.filter(e=>e.types.includes("administrative_area_level_1")),u=a.address_components.filter(e=>e.types.includes("administrative_area_level_2")),p=a.address_components.filter(e=>e.types.includes("postal_code")),v=a.address_components.filter(e=>e.types.includes("route")),a=(a.address_components.filter(e=>e.types.includes("street_number")),document.getElementById("autocomplete").innerHTML=a.name,miSetInputsNewValue(n,lat),miSetInputsNewValue(r,lng),m[0]?.short_name?miSetInputsNewValue(i,m[0]?.short_name||""):o&&(t.style.display="block",miSetInputsNewValue(i,""),d)&&(d.disabled=!0),u[0]?.short_name?miSetInputsNewValue(s,u[0]?.short_name||""):o&&(t.style.display="block",miSetInputsNewValue(s,""),d)&&(d.disabled=!0),p[0]?.short_name?miSetInputsNewValue(c,p[0]?.short_name||""):o&&(t.style.display="block",miSetInputsNewValue(c,""),d)&&(d.disabled=!0),v[0]?.long_name?miSetInputsNewValue(l,v[0]?.long_name||""):o&&(t.style.display="block",miSetInputsNewValue(l,""),d)&&(d.disabled=!0),document.getElementById("table-regiao-imoveis"));if(a){u=a.querySelector('[type="search"');if(u){u.value=m[0]?.short_name,u.dispatchEvent(new Event("keyup"));let a=miNormalizeText(m[0]?.short_name);(e=document.querySelectorAll('[name="regiao-terms[]"]')).forEach(e=>{var t=miNormalizeText(e.getAttribute("data-name"));a===t&&(e.checked=!0,e.dispatchEvent(new Event("change")))})}}}else{document.getElementById("autocomplete").placeholder="Digite um endereço",miSetInputsNewValue(n,""),miSetInputsNewValue(r,""),miSetInputsNewValue(i,""),miSetInputsNewValue(s,""),miSetInputsNewValue(c,""),miSetInputsNewValue(l,""),t.style.display="block",d&&(d.disabled=!0);p=document.getElementById("table-regiao-imoveis");p&&(v=p.querySelector('[type="search"'))&&((e=document.querySelectorAll('[name="regiao-terms[]"]')).forEach(e=>{e.checked=!1,e.dispatchEvent(new Event("change"))}),v.value="",v.dispatchEvent(new Event("keyup")))}else console.error("Não foi possível encontrar o input de longitude");else console.error("Não foi possível encontrar o input de latitude")}else console.error("Não foi possível encontrar o formulário do autocomplete")}function initGoogleApi(){window.addEventListener("load",function(){miInitAutocomplete()})}(()=>{function d(e,t,a){var l=document.createElement("div");l.classList.add("mt-3"),l.innerHTML=[`<div id="contact-form-alert" class="alert alert-${a} alert-dismissible" role="alert">`,`   <div>${t}</div>`,'   <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>',"</div>"].join(""),e.append(l)}function a(){var e=document.getElementById("operacao-filter");if(e){let n=document.getElementById("operacao-term");if(n,n){let o=e.querySelectorAll(".nav-link-item");o.forEach(l=>{l.addEventListener("click",e=>{e.preventDefault(),console.log("nav-link-item");var t,a,e=l.getAttribute("data-term-id");t=o,a="active",t.forEach(e=>{e.classList.remove(a)}),l.classList.add("active"),n.value=e})})}}}function l(){let n=document.getElementById("user_pass");if(n,n){let o=document.querySelectorAll(".meter-section");o.length<=0||n.addEventListener("keyup",()=>{{var a=n,l=o;let e=a.value,t=(e=>{let t=0;return t+=.2*e.length,/[A-Z]/.test(e)&&(t+=.5),/[a-z]/.test(e)&&(t+=.5),/\d/.test(e)&&(t+=.7),/[^A-Za-z0-9]/.test(e)&&(t+=1),t})(e);l.forEach(e=>{e.classList.remove("weak","medium","strong","very-strong")}),1<=t&&l[0].classList.add("weak"),2<=t&&l[1].classList.add("medium"),3<=t&&l[2].classList.add("strong"),4<=t&&l[3].classList.add("very-strong"),console.log("strength",t)}})}}function o(){document.querySelectorAll(".galeria-preview").forEach(e=>{let n=e.querySelector('input[type="file"]'),r=n.getAttribute("data-img-qty"),i=n.getAttribute("data-max-img-qty"),s=e.querySelector(".box-img-upload"),c=e.querySelector(".file-name"),d=c.innerText;c.setAttribute("data-original-text",d);e=e.querySelector(".btn-clear-file-upload");n.addEventListener("change",t=>{for(var t=t.target.files,e=t.length,a=(console.log("selectedFilesQty",e),console.log("imgQty",r),console.log("maxImgQty",i),console.log("fileInput",n.value),s);a.firstChild;)a.removeChild(a.lastChild);if(e+parseInt(r)>parseInt(i))console.log("Quantidade máxima de imagens atingida."),c.innerText="Quantidade máxima de imagens atingida.",n.value="";else{d=c.getAttribute("data-original-text")?c.getAttribute("data-original-text"):d,c.innerText=0<t.length?"":d;let e=0;for(var l of t){var o=document.createElement("img"),l=(o.classList.add("image-preview"),o.src=URL.createObjectURL(l),document.createElement("div"));l.classList.add("item-upload"),l.append(o),l.append(o),s.append(l),e++}c.innerText=e+" arquivos adicionados."}}),e.addEventListener("click",e=>{e.preventDefault(),n.value="",n.dispatchEvent(new Event("change"))})})}function n(){let t=document.getElementById("uploadfile");if(t,t){let a=t.querySelector('input[type="file"]');function l(e){e.preventDefault(),e.stopPropagation()}function o(e){t.classList.add("highlight")}function n(e){t.classList.remove("highlight")}a,a&&(["dragenter","dragover","dragleave","drop"].forEach(e=>{t.addEventListener(e,l,!1)}),["dragenter","dragover"].forEach(e=>{t.addEventListener(e,o,!1)}),["dragleave","drop"].forEach(e=>{t.addEventListener(e,n,!1)}),t.addEventListener("drop",function(e){e=e.dataTransfer,e=e.files;(e=>{let t=new DataTransfer;[...a.files].forEach(e=>{t.items.add(e)}),[...e].forEach(e=>{console.log(e),t.items.add(e)}),a.files=t.files,a.dispatchEvent(new Event("change"))})(e)},!1))}}function i(t,a,l,o){t.querySelector(a).addEventListener("click",e=>{e.preventDefault(),t.remove();e=l.querySelectorAll(o);0===e.length&&r(l,o,a),console.log("selectorItem",e.length),s(l,o)})}function r(e,t,a){var l,o,n=e.querySelectorAll(t),r=(n=n.length+1,(l=document.createElement("span")).classList.add("caracteristica-number"),l.innerText=n,(r=document.createElement("label")).setAttribute("for","característica-"+n),r.append(l),(l=document.createElement("input")).id="característica-"+n,l.type="text",l.name="caracteristicas-especificas[]",l.classList.add("form-control"),l.classList.add("style-1"),(n=document.createElement("a")).href="#",n.classList.add("delete-item"),n.classList.add("icon-link"),n.innerHTML='<span class="icon icon-trash"></span>',(o=document.createElement("div")).classList.add("input-icon-group"),o.append(l),o.append(n),(l=document.createElement("fieldset")).classList.add("box"),l.classList.add("box-fieldset"),l.append(r),l.append(o),(n=document.createElement("div")).classList.add("caracteristica-group"),n.classList.add("repeater-group-list"),n.append(l),n);e.append(r),i(r,a,e,t)}function s(e,t){e=e.querySelectorAll(t);e.forEach(e=>{e.removeAttribute("data-index")}),e.forEach((e,t)=>{t+=1,e.setAttribute("data-index",t),e=e.querySelector("label");e&&(e.innerText=t)})}function c(e,t,a){console.log(t);var l=document.createElement("div");l.innerHTML=[`<div id="contact-form-alert" class="alert alert-${a} alert-dismissible" role="alert">`,`   <div>${t}</div>`,'   <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>',"</div>"].join(""),e.append(l)}function m(){document.querySelectorAll(".mi-toggle-favorite").forEach(l=>{l.addEventListener("submit",e=>{var t;e.preventDefault(),document.getElementById("contact-form-alert"),document.getElementById("contact-form-alert")&&bootstrap.Alert.getOrCreateInstance("#contact-form-alert").close();let a=l.querySelector("button");a,a&&!a.disabled&&(a.disabled=!0,e=ajax_object.ajax_url,(t=new FormData(l)).get("action"),console.log(t.get("action")),fetch(e,{method:"POST",body:t}).then(e=>e.json()).then(e=>{if(console.log("response",e),e.success)"added"===e.data.status?a.classList.add("favorited"):a.classList.remove("favorited");else{var l,o,n="mi-modal-favorite",r="Atenção!",i=e.data.msg;let t=document.getElementById(n),a=(t,t||((t=document.createElement("div")).id=n,t.classList.add("modal"),t.classList.add("fade"),t.setAttribute("aria-hidden",!0),(n=document.createElement("div")).classList.add("modal-dialog"),t.append(n),(l=document.createElement("div")).classList.add("modal-content"),n.append(l),(n=document.createElement("div")).classList.add("modal-header"),l.append(n),(o=document.createElement("h5")).classList.add("modal-title"),o.innerText=r,n.append(o),(r=document.createElement("button")).classList.add("btn-close"),r.type="button",r.setAttribute("data-bs-dismiss","modal"),r.setAttribute("aria-label","Close"),n.append(r),(o=document.createElement("div")).classList.add("modal-body"),o.innerHTML=`<p>${i}</p>`,l.append(o),document.querySelector("body").prepend(t)),new bootstrap.Modal(t,{backdrop:!0,focus:!0,keyboard:!0}));a.show(),t.addEventListener("hidden.bs.modal",e=>{a.dispose(),t.remove()})}console.log(e.data.msg)}).catch(e=>{console.error(e)}).finally(()=>{a.disabled=!1}))})})}window.addEventListener("load",function(){e=document.querySelectorAll(".needs-validation"),Array.from(e).forEach(t=>{t.addEventListener("submit",e=>{"previous-step"===e.submitter.name||t.checkValidity()||(e.preventDefault(),e.stopPropagation()),"previous-step"!==e.submitter.name&&t.classList.add("was-validated")},!1)}),document.querySelectorAll(".mi-newsletter-form").forEach(r=>{r.addEventListener("submit",o=>{if(o.preventDefault(),document.getElementById("newsletter-form-alert"),document.getElementById("newsletter-form-alert")&&bootstrap.Alert.getOrCreateInstance("#newsletter-form-alert").close(),r.checkValidity()){r.classList.add("was-validated");let a=r.querySelector("#email"),l=r.querySelector("button");if(l,l&&!l.disabled){l.disabled=!0;let e=l.innerHTML;l.innerHTML="Enviando...";var o=ajax_object.ajax_url,n=new FormData(r);n.get("action");let t=document.getElementById("newsletter-form-alert-placeholder");fetch(o,{method:"POST",body:n}).then(e=>e.json()).then(e=>{d(t,e.data.msg,"success"),a.value=""}).catch(e=>{d(t,e,"danger")}).finally(()=>{l.disabled=!1,l.innerHTML=e,r.classList.remove("was-validated")})}}})}),document.querySelectorAll(".archive-layout").forEach(e=>{e.querySelectorAll(".nav-link-item").forEach(e=>{e.addEventListener("shown.bs.tab",e=>{let a=e.target.getAttribute("data-layout");e=new URL(window.location.href);"grid"===a?e.searchParams.delete("layout"):e.searchParams.set("layout",a),window.history.pushState({},"",e),document.querySelectorAll(".wd-navigation").forEach(e=>{e.querySelectorAll("a").forEach(e=>{var t=new URL(e.href);"grid"===a?t.searchParams.delete("layout"):t.searchParams.set("layout",a),e.href=t.toString()})})})})}),document.querySelectorAll(".archive-sort").forEach(e=>{e.querySelectorAll("ul").forEach(e=>{e.querySelectorAll("li").forEach(e=>{e.addEventListener("click",e=>{var e=e.target.getAttribute("data-value"),t=new URL(window.location.href);e?t.searchParams.set("orderby",e):t.searchParams.delete("orderby"),window.history.pushState({},"",t),window.location=t})})})}),document.querySelectorAll(".select-list").forEach(e=>{let a=e.querySelector("[data-select-list-value]");e.querySelectorAll("li").forEach(t=>{t.addEventListener("click",()=>{console.log("selectLists click");t.getAttribute("data-value");var e=t.getAttribute("data-term-id");a,a&&(a.value=e,console.log("click",e))})})}),a(),document.querySelectorAll(".toogle-preview").forEach(e=>{var t=e.querySelector(".imovel-content");console.log("imovelContent",t.offsetHeight);let o=e.querySelector(".toogle-preview-content"),n=e.querySelector(".toogle-preview-btn");80<=t.offsetHeight?n.addEventListener("click",e=>{e.preventDefault();var e=n.innerText,t=n.getAttribute("data-text"),a=n.getAttribute("data-anchor"),a=document.getElementById(a),l=n.querySelector(".text");o.classList.toggle("expanded"),l.innerText=t,n.setAttribute("data-text",e),!o.classList.contains("expanded")&&a&&a.scrollIntoView()}):(n.remove(),o.classList.toggle("expanded"))}),document.querySelectorAll(".mi-anunciante-contact-form").forEach(c=>{c.addEventListener("submit",i=>{if(i.preventDefault(),document.getElementById("anunciante-contact-form-alert"),document.getElementById("anunciante-contact-form-alert")&&bootstrap.Alert.getOrCreateInstance("#anunciante-contact-form-alert").close(),c.checkValidity()){c.classList.add("was-validated");let a=c.querySelector("#nome"),l=c.querySelector("#phone"),o=c.querySelector("#email"),n=c.querySelector("#mensagem"),r=c.querySelector("button");if(r,r&&!r.disabled){r.disabled=!0;let e=r.innerText;r.innerText="Enviando...";var i=ajax_object.ajax_url,s=new FormData(c);s.get("action");let t=document.getElementById("anunciante-contact-form-alert-placeholder");fetch(i,{method:"POST",body:s}).then(e=>e.json()).then(e=>{d(t,e.data.msg,"success"),a.value="",l.value="",o.value="",n.value=""}).catch(e=>{d(t,e,"danger")}).finally(()=>{r.disabled=!1,r.innerText=e,c.classList.remove("was-validated")})}}})}),e=document.querySelectorAll(".go-back-btn"),Array.from(e).forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),history.back()})}),l(),document.querySelectorAll(".my-imoveis-select").forEach(e=>{e.querySelectorAll("ul").forEach(e=>{e.querySelectorAll("li").forEach(e=>{e.addEventListener("click",e=>{var e=e.target.getAttribute("data-value"),t=new URL(window.location.href);e?t.searchParams.set("orderby",e):t.searchParams.delete("orderby"),window.history.pushState({},"",t),window.location=t})})})}),(e=document.getElementById("user_phone"))&&IMask(e,{mask:"+00[000000000000]"}),(e=document.getElementById("phone"))&&IMask(e,{mask:"+00[000000000000]"}),document.getElementById("user_whatsapp");var e=document.getElementById("imovel_price"),t={mask:"num",blocks:{num:{mask:Number,scale:2,thousandsSeparator:".",padFractionalZeros:!0,radix:",",mapToRadix:["."]}}};e&&IMask(e,t),document.querySelectorAll(".mi-file-image-preview").forEach(e=>{let t=e.querySelector('input[type="file"]'),l=e.querySelector(".images-preview"),o=e.querySelector(".btn-clear-image"),n=e.querySelector('input[name="changed-thumbnail"]');o.addEventListener("click",e=>{for(e.preventDefault(),t.value=null;l.firstChild;)l.removeChild(l.lastChild);o.style.display="none",n.value="true"}),t.addEventListener("change",e=>{for(var t,e=e.target.files;l.firstChild;)l.removeChild(l.lastChild);for(t of e){var a=document.createElement("img");a.classList.add("image-preview"),a.src=URL.createObjectURL(t),l.append(a)}o.style.display="block",n.value="true"})}),document.querySelectorAll(".mi-repeater").forEach(e=>{let t=e.querySelector(".repeater-group");e=e.querySelector(".add-group");let a=".repeater-group-list",l=".delete-item";s(t,a),e.addEventListener("click",e=>{e.preventDefault(),r(t,a,l),s(t,a)}),t.querySelectorAll(a).forEach(e=>{i(e,l,t,a)})}),o(),document.querySelectorAll(".galeria-imovel-management").forEach(e=>{var t=e.querySelectorAll(".galeria-imovel-item");let a=e.querySelectorAll(".remove-galeria-imovel-item");t.forEach((t,e)=>{a[e].addEventListener("click",e=>{e.preventDefault(),console.log("click"),t.remove()})})}),n(),new Swiper(".home-destaque-swiper",{slidesPerView:1,spaceBetween:30,autoplay:{delay:3e3,disableOnInteraction:!1},breakpoints:{768:{slidesPerView:2},992:{slidesPerView:2},1200:{slidesPerView:3}}}),document.querySelectorAll(".mi-contact-form").forEach(s=>{s.addEventListener("submit",r=>{if(r.preventDefault(),document.getElementById("contact-form-alert"),document.getElementById("contact-form-alert")&&bootstrap.Alert.getOrCreateInstance("#contact-form-alert").close(),s.checkValidity()){s.classList.add("was-validated");let a=s.querySelector("#nome"),l=s.querySelector("#email"),o=s.querySelector("#mensagem"),n=s.querySelector("button");if(n,n&&!n.disabled){n.disabled=!0;let e=n.innerText;n.innerText="Enviando...";var r=ajax_object.ajax_url,i=new FormData(s);i.get("action");let t=document.getElementById("contact-form-alert-placeholder");fetch(r,{method:"POST",body:i}).then(e=>e.json()).then(e=>{console.log("response",e),e.success?(c(t,e.data.msg,"success"),a.value="",l.value="",o.value=""):c(t,e.data.msg,"danger")}).catch(e=>{console.error(e),c(t,e,"danger")}).finally(()=>{n.disabled=!1,n.innerText=e,s.classList.remove("was-validated")})}}})});{let e=document.querySelectorAll('input[type="radio"]');e.forEach(t=>{t.addEventListener("click",()=>{"true"===t.dataset.checked?(t.checked=!1,t.dataset.checked="false"):(e.forEach(e=>{e.name===t.name&&(e.checked=!1,e.dataset.checked="false")}),t.checked=!0,t.dataset.checked="true")})})}m()})})();